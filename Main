/*
 * Creators: David, Mehr, Shreya
 * Teacher: Ms. Karasinska
 * ICS4U1 ISU - Pac's Shadow Adventures
 */

import java.awt.*;

import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.Clip;
import javax.sound.sampled.FloatControl;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.UnsupportedAudioFileException;
import javax.swing.*;
import java.awt.event.*;
import java.io.File;
import java.io.IOException;

public class PlayGame extends JPanel
{
	// Menu
	Menu titleScreen = new Menu(296, 350);
	
	public PlayGame()
	{
		addKeyListener(new KeyListener() 
		{
			@Override
			public void keyTyped(KeyEvent e) 
			{

			}
			@Override
			public void keyReleased(KeyEvent e) 
			{
				
			}
			@Override
			public void keyPressed(KeyEvent e) 
			{
				titleScreen.keyPressed(e);
			}
		});
		setFocusable(true);
	}
	
	private void move()
	{
		titleScreen.move();
	}
	
	@Override
	public void paint(Graphics g)
	{
		super.paint(g);
	    Graphics2D g2d = (Graphics2D) g;
	    g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
	    RenderingHints.VALUE_ANTIALIAS_ON);
	    titleScreen.paint(g2d);
	}
	
	public static void main(String[] args) throws InterruptedException, UnsupportedAudioFileException, IOException, LineUnavailableException
	{
		// Music
		File music = new File("8-bit-FunnyMusic.wav");
		AudioInputStream stream = AudioSystem.getAudioInputStream(music); 
		Clip clip = AudioSystem.getClip();  
	    clip.open(stream);
	    clip.loop(Clip.LOOP_CONTINUOUSLY); 
	    FloatControl volumeControl = (FloatControl) clip.getControl(FloatControl.Type.MASTER_GAIN);
	    float maxVolume = volumeControl.getMaximum();
	    float minVolume = volumeControl.getMinimum();
	    float range = maxVolume - minVolume;
	    float volume = -18;
	    float INCREMENT = Math.abs(range/10);
	    volumeControl.setValue(volume);
	    clip.start();
	   
	    // Raise or lower volume
		if (Menu.getVolRaise() == true)
		{
			volume += INCREMENT;
			volumeControl.setValue(volume);
		}
		
		if (Menu.getVolLower() == true)
		{
			volume -= INCREMENT;
			volumeControl.setValue(volume);
		}

		// Frame
		JFrame frame = new JFrame("Pac's Shadow Adventures");
		PlayGame game = new PlayGame();
		frame.add(game);
		frame.setSize(1016, 839);
	    frame.setVisible(true);
	    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

	    while (true) 
	    {
	      game.move();
	      game.repaint();
	      Thread.sleep(10);
	    }
	}
}
